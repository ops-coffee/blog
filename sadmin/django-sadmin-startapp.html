<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="applicable-device" content="pc,mobile">
  <meta name="keywords" content="Django app development, Django startapp, Django models, Django views, Django templates, Django URLs, Django migrations, Django permissions, Django coffee app, Django web development" />
  <meta name="description" content="æœ¬æ•™ç¨‹è¯¦ç»†ä»‹ç»äº†å¦‚ä½•åœ¨Djangoä¸­åˆ›å»ºä¸€ä¸ªåä¸ºCoffeeçš„åº”ç”¨ï¼ŒåŒ…æ‹¬åˆ›å»ºåº”ç”¨ã€å®‰è£…åº”ç”¨ã€æ·»åŠ æ¨¡å‹ã€è§†å›¾ã€æ¨¡æ¿ä»¥åŠURLé…ç½®çš„å®Œæ•´æ­¥éª¤ã€‚" />
  <link rel="alternate" type="application/rss+xml" title="è¿ç»´å’–å•¡å§" href="https://blog.ops-coffee.cn/feed.xml" />
  <link rel="stylesheet" href="https://blog.ops-coffee.cn/static/posts/css/ops-coffee.min.css" type="text/css" />

  <!-- Begin SEO tag -->
  <title>åŸºäºSadminæ–°å»ºAPP</title>
  <meta property="og:locale" content="zh_CN" />
  <meta property="og:site_name" content="è¿ç»´å’–å•¡å§" />
  <meta property="og:url" content="https://blog.ops-coffee.cn" />
  <meta property="og:title" content="åŸºäºSadminæ–°å»ºAPP" />
  <meta property="og:description" content="æœ¬æ•™ç¨‹è¯¦ç»†ä»‹ç»äº†å¦‚ä½•åœ¨Djangoä¸­åˆ›å»ºä¸€ä¸ªåä¸ºCoffeeçš„åº”ç”¨ï¼ŒåŒ…æ‹¬åˆ›å»ºåº”ç”¨ã€å®‰è£…åº”ç”¨ã€æ·»åŠ æ¨¡å‹ã€è§†å›¾ã€æ¨¡æ¿ä»¥åŠURLé…ç½®çš„å®Œæ•´æ­¥éª¤ã€‚" />
  <link rel="canonical" href="https://blog.ops-coffee.cn" />
  <!-- End SEO tag -->
</head>

<body>
  <div class="header">
    <div class="menu-button">&#9776; 
        <span class="menu-title">è¿ç»´å’–å•¡å§</span>
    </div> 

    <div class="container no-sidebar">
      <nav class="header-site">
        <ul>
          <li><a href="/">é¦–é¡µ</a></li>
            <li class="has-submenu">
              <a href="#" target="_self">è¿ç»´</a>
              <ul class="sub-menu">
                <li><a href="/tag/ç³»ç»Ÿè¿ç»´/" target="_self">ç³»ç»Ÿè¿ç»´</a></li>
                <li><a href="/elk/index.html" target="_self">ELKç³»åˆ—</a></li>
                <li><a href="/ldap/index.html" target="_self">LDAPç³»åˆ—</a></li>
              </ul>
            </li>
            <li class="has-submenu">
              <a href="#" target="_self">å¼€å‘</a>
              <ul class="sub-menu">
                <li><a href="/tag/Devops/" target="_self">DevOps</a></li>
                <li><a href="/tag/Python/" target="_self">Python</a></li>
                <li><a href="/tag/Django/" target="_self">Django</a></li>
                <li><a href="/bpmn/index.html" target="_self">BPMNç³»åˆ—</a></li>
                <li><a href="/webssh/index.html" target="_self">WebSSHç³»åˆ—</a></li>
                <li><a href="/frontend/index.html" target="_self">å‰ç«¯å¼€å‘ç³»åˆ—</a></li>
              </ul>
            </li>
            <li><a href="/devops/index.html" target="_self">è¿ç»´å¹³å°</a></li>
            <li class="has-submenu">
              <a href="#" target="_self">è¿™æ˜¯ç”Ÿæ´»</a>
              <ul class="sub-menu">
                <li><a href="/life/chronicles.html" target="_self">æ—¶å…‰å°è®°</a></li>
                <li><a href="/life/money.html" target="_self">å‰¯ä¸šèµšé’±</a></li>
                <li><a href="/life/writing.html" target="_self">å†™ä½œç›¸å…³</a></li>
                <li><a href="/tag/è¿™æ˜¯ç”Ÿæ´»/" target="_self">ç”Ÿæ´»éšç¬”</a></li>
              </ul>
            </li>
            <li class="has-submenu">
              <a href="#" target="_self">æˆ¿è½¦æ—…è¡Œ</a>
              <ul class="sub-menu">
                <li><a href="/rv.html" target="_self">æˆ¿è½¦ä½“éªŒ</a></li>
                <li><a href="/travels.html" target="_self">æ—…è¡Œæ¸¸è®°</a></li>
                <li><a href="/travel/china.html" target="_self">æ—…è¡Œåœ°å›¾</a></li>
              </ul>
            </li>
            <li><a href="/tag/index.html" target="_self">æ ‡ç­¾</a></li>
            <li><a href="/archive.html" target="_self">å½’æ¡£</a></li>
          <li class="search"><a href="/search.html" target="_self">ğŸ”</a></li>
        </ul>
      </nav>
    </div>
  </div>

  <header>
    <div class="container no-sidebar">
      <a href="/">
        <div class="name">è¿ç»´å’–å•¡å§</div>
        <div class="slogan">äº«å—æŠ€æœ¯å¸¦æ¥çš„ä¹è¶£ï¼Œä½“éªŒç”Ÿæ´»ç»™äºˆçš„æ„ŸåŠ¨</div>
      </a>
    </div>
  </header>

  <div id="content-wrap">
    <div class="container no-sidebar">
        <h1 id="art-title">åŸºäºSadminæ–°å»ºAPP</h1>

        <p>1.Start APP, Create a new app named coffee</p>
<pre class="codehilite"><code>python manage.py startapp coffee</code></pre>


<p>2.Installed APP, Edit <code>settings.py</code>ï¼Œinsert <code>coffee</code> to <code>INSTALLED_APPS</code></p>
<pre class="codehilite"><code>INSTALLED_APPS = [
    ...
    'sadmin.commons',
    'sadmin.accounts',
    'sadmin.project',
    'coffee',
]</code></pre>


<p>3.Add Model, Add <code>Production</code> model to  coffee/models.py file</p>
<pre class="codehilite"><code>from django.db import models

from sadmin.commons.backends.modles import UserBaseModel

class Production(UserBaseModel):
    name = models.CharField(max_length=32, unique=True, verbose_name='åç§°')
    code = models.CharField(max_length=16, unique=True, verbose_name='ä»£ç ')

    def __str__(self):
        return self.name

    class Meta:
        permissions = (
            (&quot;production_select&quot;, &quot;äº§å“æŸ¥çœ‹æƒé™&quot;),
            (&quot;production_change&quot;, &quot;äº§å“ä¿®æ”¹æƒé™&quot;),
        )</code></pre>


<p>4.Add View, Add <code>ProductionList</code> and <code>ProductionDetail</code> class to coffee/views.py file</p>
<pre class="codehilite"><code>from sadmin.commons.options import ListCreateView, RetrieveUpdateDestroyView

class ProductionList(ListCreateView):
    model = Tag
    template = 'coffee/production.index.html'
    permission = {'get': 'coffee.production_select', 'post': 'coffee.production_change'}


class ProductionDetail(RetrieveUpdateDestroyView):
    model = Tag
    permission = {'get': 'coffee.production_select', 'put': 'coffee.production_change', 'delete': 'coffee.production_change'}</code></pre>


<p>5.Add Template, edit coffee/templates/coffee/production.index.html file</p>
<pre class="codehilite"><code>{% extends &quot;base.html&quot; %}

{% block css %}
&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/plugins/DataTables/datatables.min.css&quot;&gt;
{% endblock %}

{% block breadcrumb %}
{% if perms.coffee.production_change %}
&lt;button class=&quot;btn btn-success&quot; type=&quot;button&quot; onclick=&quot;createForm()&quot;&gt;&lt;i class=&quot;fa fa-plus&quot;&gt;&lt;/i&gt; æ–°å»º&lt;/button&gt;
{% endif %}
{% endblock %}

{% block content %}
&lt;div class=&quot;card mb-4&quot;&gt;
  &lt;div class=&quot;card-body&quot;&gt;
    &lt;table class=&quot;table table-striped&quot; id=&quot;id_table&quot; style=&quot;width:100%&quot;&gt;
      &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;ID&lt;/th&gt;
        &lt;th&gt;åç§°&lt;/th&gt;
        {% if perms.coffee.production_change %}
        &lt;th&gt;æ“ä½œ&lt;/th&gt;
        {% endif %}
      &lt;/tr&gt;
      &lt;/thead&gt;
    &lt;/table&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;modal fade&quot; id=&quot;modalForm&quot; tabindex=&quot;-1&quot; role=&quot;dialog&quot; aria-hidden=&quot;true&quot;&gt;
  &lt;div class=&quot;modal-dialog modal-xl&quot;&gt;
    &lt;div class=&quot;modal-content&quot;&gt;
      &lt;div class=&quot;modal-header&quot;&gt;
        &lt;h5 class=&quot;modal-title&quot; id=&quot;modalForm_title&quot;&gt;&lt;/h5&gt;
        &lt;button class=&quot;btn-close&quot; type=&quot;button&quot; data-coreui-dismiss=&quot;modal&quot; aria-label=&quot;Close&quot;&gt;&lt;/button&gt;
      &lt;/div&gt;
      &lt;div class=&quot;modal-body&quot;&gt;
        &lt;div class=&quot;tab-content&quot;&gt;
          &lt;form class=&quot;form-horizontal&quot; id=&quot;modalForm_Content&quot; method=&quot;post&quot; action=&quot;&quot;&gt;{% csrf_token %}
            &lt;input type=&quot;text&quot; autocomplete=&quot;off&quot; id=&quot;form_id&quot; value=&quot;0&quot; hidden&gt;

            &lt;div class=&quot;row mb-3&quot;&gt;
              &lt;label class=&quot;col-2 col-form-label text-end&quot;&gt;* åç§°&lt;/label&gt;
              &lt;div class=&quot;col-9&quot;&gt;
                &lt;input type=&quot;text&quot; autocomplete=&quot;off&quot; class=&quot;form-control&quot; id=&quot;form_name&quot; name=&quot;name&quot; required
                       placeholder=&quot;è¯·è¾“å…¥åç§°ï¼Œå‘½ååº”è§åçŸ¥æ„&quot;&gt;
              &lt;/div&gt;
            &lt;/div&gt;

            &lt;div class=&quot;modal-footer&quot;&gt;
              &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-coreui-dismiss=&quot;modal&quot;&gt;Close&lt;/button&gt;
              &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;Save Changes&lt;/button&gt;
            &lt;/div&gt;
          &lt;/form&gt;
        &lt;/div&gt;

      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
{% endblock %}


{% block js %}
&lt;script type=&quot;text/javascript&quot; src=&quot;/static/plugins/DataTables/datatables.min.js&quot;&gt;&lt;/script&gt;

&lt;script&gt;
  $('#page_header').text('Productionç®¡ç†');
  $('#page_header_descript').text('');

  // åŠ è½½è¡¨æ ¼
  var table = $('#id_table').DataTable({
    &quot;ajax&quot;: {
      &quot;url&quot;: window.location.pathname,
      &quot;data&quot;: function (d) {
        // å»æ‰columnså¼€å¤´çš„å‚æ•°
        for(var key in d){
          if (key.indexOf(&quot;columns&quot;)==0||key.indexOf(&quot;order&quot;)==0) {
            delete d[key];
          }
        }
      }
    },
    &quot;columns&quot;: [
      {&quot;data&quot;: &quot;id&quot;},
      {&quot;data&quot;: &quot;name&quot;},
      {% if perms.coffee.production_change %}
      {
        &quot;data&quot;: &quot;id&quot;,
        &quot;render&quot;: function (data, type, row) {
          return '&lt;button class=&quot;btn btn-warning btn-sm&quot; onclick=&quot;updateForm('+row.id+')&quot;&gt;&lt;i class=&quot;fa fa-pencil-square-o&quot;&gt;&lt;/i&gt; ç¼–è¾‘&lt;/button&gt;&amp;nbsp;' +
                 '&lt;button class=&quot;btn btn-danger btn-sm&quot; onclick=&quot;deleteForm(&amp;quot;'+ window.location.pathname +'&amp;quot;, '+row.id+')&quot;&gt;&lt;i class=&quot;fa fa-trash&quot;&gt;&lt;/i&gt; åˆ é™¤&lt;/button&gt;'
        }
      }
      {% endif %}
    ]
  });

  // ç‚¹å‡»åˆ›å»ºæ—¶çš„è¡¨å•ä¿¡æ¯
  function createForm() {
    $('#modalForm_title').text('æ·»åŠ Production');
    $('#modalForm_Content').trigger(&quot;reset&quot;);

    $('#modalForm').modal('show');
  }

  // ç‚¹å‡»ç¼–è¾‘æ—¶çš„è¡¨å•ä¿¡æ¯
  function updateForm(id) {
    $('#modalForm_title').text('ä¿®æ”¹Production');
    $('#modalForm_Content').trigger(&quot;reset&quot;);

    var data = {
      &quot;format&quot;: &quot;json&quot;,
    }

    $.get(window.location.pathname + id + &quot;/&quot;, data, function(data) {
      if (data.state) {
        $.each(data.data, function (k, v) {
          $('#form_' + k).val(v);
        });

        $('#modalForm').modal('show');
      } else {
        toastr.error(data.message);
      }
    });
  }

  // ä½¿ç”¨ajax submitæäº¤è¡¨å•æ•°æ®
  $('#modalForm_Content').submit(function (event) {
    event.preventDefault();

    if (confirm(&quot;ç¡®è®¤æäº¤è¿™äº›æ•°æ®å—ï¼Ÿ&quot;)) {
      var formid = $('#form_id').val();
      var params = $('#modalForm_Content').serializeJson();

      if (formid == &quot;0&quot;) {
        $.post(window.location.pathname, JSON.stringify(params), function(data, status){
          if (data.state) {
            table.draw(false);
            toastr.success(data.message);
            $('#modalForm').modal('hide');
          } else {
            toastr.error(data.message)
          }
        });
      } else {
        params.id = formid;
        $.put(window.location.pathname + formid + &quot;/&quot;, JSON.stringify(params), function(data, status){
          if (data.state) {
            table.draw(false);
            toastr.success(data.message);
            $('#modalForm').modal('hide');
          } else {
            toastr.error(data.message)
          }
        });
      }
    }
  });
&lt;/script&gt;
{% endblock %}</code></pre>


<p>6.Add URL, Add <code>production/</code> and <code>production/&lt;int:pk&gt;/</code> URL to coffee/views.py file</p>
<pre class="codehilite"><code>from . import views
from django.urls import path

urlpatterns = [
    path('production/', views.ProductionInstanceList.as_view(), name='production-list-url'),
    path('production/&lt;int:pk&gt;/', views.ProductionInstanceDetail.as_view(), name='production-detail-url'),
]</code></pre>


<p>Insert coffee path to webapp/urls.py file</p>
<pre class="codehilite"><code>from django.urls import path, include, re_path

urlpatterns = [
    ...
    path('coffee/', include('coffee.urls')),
]</code></pre>


<p>7.Makemigrations &amp; Migrate</p>
<pre class="codehilite"><code>python manage.py makemigrations
python manage.py migrate</code></pre>


<p>8.Runserver</p>

        <div>
          <ul style="display: inline-block;padding: 0;margin: 0 0 0.5em;color: #999;">
            <li style="display: inline-block;margin: 0 1em 0 0;"><a href="/sadmin/django-sadmin-startapp.html">ğŸ“… 2023-03-28</a></li>
          </ul>
        </div>

        <hr>

        <div class="pagination">
            <a href="https://blog.ops-coffee.cn/s/devops-automation-journey-team-learning.html" class="pagination-item prev-page">
                <span class="pagination-arrow">â†</span>
                <span class="pagination-text">ä¸Šä¸€ç¯‡ï¼š<br>å¸¦ä¸€ç¾¤ä¼™ä¼´å†™ä¸€æ¬¾è½¯ä»¶</span>
            </a>
            <a href="https://blog.ops-coffee.cn/s/devops-task-subtask-jenkins.html" class="pagination-item next-page">
                <span class="pagination-text">ä¸‹ä¸€ç¯‡ï¼š<br>ä»»åŠ¡ç³»ç»Ÿä¹‹Jenkinså­ä»»åŠ¡</span>
                <span class="pagination-arrow">â†’</span>
            </a>
        </div>

        <div class="nav-cell">
    <script async src="https://giscus.app/client.js"
            data-repo="ops-coffee/blog" data-repo-id="MDEwOlJlcG9zaXRvcnkxNDY4OTI0MTg="
            data-category="Announcements" data-category-id="DIC_kwDOCMFmgs4CQar3"
            data-mapping="pathname" data-strict="0" data-reactions-enabled="1"
            data-emit-metadata="0" data-input-position="top" data-theme="light"
            data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous">
    </script>
</div>

        <div>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8944257246828217"
         data-ad-slot="6731434232" data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</div>

        <div class="nav-cell">
            <p class="nav-list-title">èƒ½çœ‹åˆ°è¿™é‡Œä¸€å®šæ˜¯çœŸçˆ±ï¼Œè®¢é˜…ä¸€ä¸‹å§</p>
            <img alt="" loading="lazy" src="/static/images/wx.sou1.png" />
        </div>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
      <div class="copy"> Â© ops-coffee</div>

      <div class="link">
        <a href="/comments.html" title="ç»™æˆ‘ç•™è¨€" target="_blank">ç•™è¨€</a>
        <a href="/friends.html" title="å‹æƒ…é“¾æ¥" target="_blank">å‹é“¾</a>
      </div>
    </div>
  </footer>
  
  <!-- Umami Cloud -->
<script async src="https://umami.ops-coffee.cn/script.js" data-website-id="a4aabd8e-32c7-40e7-a81c-119b909f2d0f"></script>

<!-- Google Adsense -->
<script data-ad-client="ca-pub-8944257246828217" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</body>

</html>