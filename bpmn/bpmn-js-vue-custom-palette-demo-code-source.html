<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="applicable-device" content="pc,mobile">
  <meta name="keywords" content="Palette,js,Shape,bpmn,å…³äºæŠ€æœ¯,BPMN" />
  <meta name="description" content="BPMNè‡ªå®šä¹‰bpmn.jsçš„å·¥å…·æ Paletteï¼Œå®ç°éšè—ã€æ·»åŠ ã€ä¿®æ”¹Shape" />
  <link rel="alternate" type="application/rss+xml" title="è¿ç»´å’–å•¡å§" href="https://blog.ops-coffee.cn/feed.xml" />
  <link rel="stylesheet" href="https://blog.ops-coffee.cn/static/posts/css/ops-coffee.min.css" type="text/css" />

  <!-- Begin SEO tag -->
  <title>æœ€å¥½ç”¨çš„æµç¨‹ç¼–è¾‘å™¨bpmn-jsç³»åˆ—ä¹‹Palette</title>
  <meta property="og:locale" content="zh_CN" />
  <meta property="og:site_name" content="è¿ç»´å’–å•¡å§" />
  <meta property="og:url" content="https://blog.ops-coffee.cn" />
  <meta property="og:title" content="æœ€å¥½ç”¨çš„æµç¨‹ç¼–è¾‘å™¨bpmn-jsç³»åˆ—ä¹‹Palette" />
  <meta property="og:description" content="BPMNè‡ªå®šä¹‰bpmn.jsçš„å·¥å…·æ Paletteï¼Œå®ç°éšè—ã€æ·»åŠ ã€ä¿®æ”¹Shape" />
  <link rel="canonical" href="https://blog.ops-coffee.cn" />
  <!-- End SEO tag -->
</head>

<body>
  <div class="header">
    <div class="container">
      <nav class="header-site">
        <ul>
          <li><a href="/">é¦–é¡µ</a></li>
            <li class="has-submenu">
              <a href="#" target="_self">è¿ç»´</a>
              <ul class="sub-menu">
                <li><a href="/tag/ç³»ç»Ÿè¿ç»´/" target="_self">ç³»ç»Ÿè¿ç»´</a></li>
                <li><a href="/elk/index.html" target="_self">ELKç³»åˆ—</a></li>
                <li><a href="/ldap/index.html" target="_self">LDAPç³»åˆ—</a></li>
              </ul>
            </li>
            <li class="has-submenu">
              <a href="#" target="_self">å¼€å‘</a>
              <ul class="sub-menu">
                <li><a href="/tag/Devops/" target="_self">DevOps</a></li>
                <li><a href="/tag/Python/" target="_self">Python</a></li>
                <li><a href="/tag/Django/" target="_self">Django</a></li>
                <li><a href="/bpmn/index.html" target="_self">BPMNç³»åˆ—</a></li>
                <li><a href="/webssh/index.html" target="_self">WebSSHç³»åˆ—</a></li>
                <li><a href="/frontend/index.html" target="_self">å‰ç«¯å¼€å‘ç³»åˆ—</a></li>
              </ul>
            </li>
            <li><a href="/devops.html" target="_self">è¿ç»´å¹³å°</a></li>
            <li><a href="/tag/è¿™æ˜¯ç”Ÿæ´»/" target="_self">è¿™æ˜¯ç”Ÿæ´»</a></li>
            <li class="has-submenu">
              <a href="#" target="_self">æˆ¿è½¦æ—…è¡Œ</a>
              <ul class="sub-menu">
                <li><a href="/r/index.html" target="_self">æˆ¿è½¦ä½“éªŒ</a></li>
                <li><a href="/travels.html" target="_self">æ—…è¡Œæ¸¸è®°</a></li>
              </ul>
            </li>
            <li><a href="/tag/index.html" target="_self">æ ‡ç­¾</a></li>
            <li><a href="/archive.html" target="_self">å½’æ¡£</a></li>
        </ul>
      </nav>
    </div>
  </div>

  <header>
    <div class="container">
      <a href="/">
        <h1>è¿ç»´å’–å•¡å§</h1>
        <h2>äº«å—æŠ€æœ¯å¸¦æ¥çš„ä¹è¶£ï¼Œä½“éªŒç”Ÿæ´»ç»™äºˆçš„æ„ŸåŠ¨</h2>
      </a>
    </div>
  </header>

  <div id="content-wrap">
    <div class="container no-sidebar">
        <h1 id="art-title">æœ€å¥½ç”¨çš„æµç¨‹ç¼–è¾‘å™¨bpmn-jsç³»åˆ—ä¹‹Palette</h1>

        <blockquote>
<p>æœ€å¥½ç”¨çš„æµç¨‹ç¼–è¾‘å™¨bpmn-jsç³»åˆ—æ–‡ç« </p>
</blockquote>
<p>å‰è¾¹å†™äº†å››ç¯‡æ–‡ç« ä»‹ç»äº†bpmn.jsçš„åŸºæœ¬ä½¿ç”¨ï¼Œæœ€è¿‘é™†ç»­æœ‰å°ä¼™ä¼´åŠ æˆ‘å‚¬æ›´ï¼Œæ„Ÿè°¢å¯¹æˆ‘è¿™ä¸ªåŠåŠå­å‰ç«¯çš„ä¿¡ä»»ï¼Œæ¥ç€æ›´æ–°bpmn.jsçš„ä¸€äº›é«˜çº§ç”¨æ³•ï¼Œæœ¬ç¯‡ä»‹ç»å¯¹å·¦ä¾§å·¥å…·æ Paletteçš„éšè—å’Œè‡ªå®šä¹‰ä¿®æ”¹</p>
<h2 id="shape">éšè—shape</h2>
<p>å·¦ä¾§å·¥å…·æ Paletteæœ‰äº›å›¾æ ‡æˆ‘ç”¨ä¸åˆ°ï¼Œé‚£è¯¥å¦‚ä½•éšè—å‘¢ï¼Ÿæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ç›´æ¥æ‰¾åˆ°å¯¹åº”çš„classï¼Œé€šè¿‡csséšè—ï¼Œä¾‹å¦‚æˆ‘ä¸éœ€è¦åˆ›å»ºæ•°æ®å­˜å‚¨ï¼Œå¯ä»¥é€šè¿‡ä¸‹è¾¹çš„ä»£ç éšè—</p>
<pre class="codehilite"><code>.bpmn-icon-data-store {
  display: none;
}</code></pre>


<h2 id="shape_1">è‡ªå®šä¹‰shape</h2>
<p>ä¸ºäº†ç¼–è¾‘æ–¹ä¾¿ï¼Œæˆ‘æƒ³åœ¨paletteä¸Šæ·»åŠ ä¸€ä¸ªshapeè¯¥å¦‚ä½•æ“ä½œå‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰Paletteï¼Œè‡ªå®šä¹‰Paletteæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥é€‰æ‹©ï¼Œç¬¬ä¸€ç§å°±æ˜¯åŸºäºé»˜è®¤çš„Paletteæ¥ä¿®æ”¹ï¼Œç¬¬äºŒç§å°±æ˜¯å®Œå…¨å†™ä¸ªæ–°çš„Paletteæ¥æ›¿ä»£é»˜è®¤çš„Paletteï¼Œç¬¬ä¸€ç§åªèƒ½åœ¨é»˜è®¤çš„Paletteä¸Šæ·»åŠ shapeï¼Œè€Œä¸èƒ½ä¿®æ”¹æˆ–åˆ é™¤ï¼Œæ¯”è¾ƒé¸¡è‚‹æˆ‘ä»¬å°±ç›´æ¥æ”¾å¼ƒäº†ï¼Œæ¥çœ‹ä¸‹å®Œå…¨è‡ªå®šä¹‰Paletteè¯¥å¦‚ä½•å®ç°</p>
<p>ä»¥ä¸‹ä»£ç åŸºäºæˆ‘ä»¬ä¹‹å‰æ­å»ºå¥½çš„ä»£ç æ¡†æ¶ï¼Œå…·ä½“å¯çœ‹æ–‡ç« <a href="https://blog.ops-coffee.cn/bpmn/bpmn-js-vue-base-usage-demo-code-source" target="_blank">ã€æœ€å¥½ç”¨çš„æµç¨‹ç¼–è¾‘å™¨bpmn-jsç³»åˆ—ä¹‹åŸºæœ¬ä½¿ç”¨ã€</a>ï¼Œ</p>
<p>1.åœ¨<code>components</code>ç›®å½•ä¸‹æ–°å»º<code>customBpmn</code>ç›®å½•ï¼Œåœ¨<code>customBpmn</code>ç›®å½•ä¸‹æ–°å»º<code>custom</code>ç›®å½•ï¼Œæ¯å±‚ç›®å½•ä¸‹éƒ½æ–°å»º<code>index.js</code>æ–‡ä»¶ï¼Œæœ€ç»ˆç›®å½•ç»“æ„å¦‚ä¸‹</p>
<p><img alt="" loading="lazy" src="/static/images/2020/1110.01.png" /></p>
<p>2.åœ¨customç›®å½•ä¸‹æ–°å»º<code>CustomPalette.js</code>æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</p>
<pre class="codehilite"><code>import { assign } from &quot;min-dash&quot;;

export default function PaletteProvider(
  palette,
  create,
  elementFactory,
  handTool,
  lassoTool,
  spaceTool,
  globalConnect,
  translate
) {
  this.create = create;
  this.elementFactory = elementFactory;
  this.handTool = handTool;
  this.lassoTool = lassoTool;
  this.spaceTool = spaceTool;
  this.globalConnect = globalConnect;
  this.translate = translate;

  palette.registerProvider(this);
}

PaletteProvider.$inject = [
  &quot;palette&quot;,
  &quot;create&quot;,
  &quot;elementFactory&quot;,
  &quot;handTool&quot;,
  &quot;lassoTool&quot;,
  &quot;spaceTool&quot;,
  &quot;globalConnect&quot;,
  &quot;translate&quot;
];

PaletteProvider.prototype.getPaletteEntries = function (element) {
  const {
    create,
    elementFactory,
    handTool,
    lassoTool,
    spaceTool,
    globalConnect,
    translate
  } = this;

  function createAction(type, group, className, title, options) {
    function createListener(event) {
      var shape = elementFactory.createShape(assign({ type: type }, options));

      if (options) {
        shape.businessObject.di.isExpanded = options.isExpanded;
      }

      create.start(event, shape);
    }

    var shortType = type.replace(/^bpmn:/, &quot;&quot;);

    return {
      group: group,
      className: className,
      title: title || translate(&quot;Create {type}&quot;, { type: shortType }),
      action: {
        dragstart: createListener,
        click: createListener
      }
    };
  }

  return {
    &quot;lasso-tool&quot;: {
      group: &quot;tools&quot;,
      className: &quot;bpmn-icon-lasso-tool&quot;,
      title: &quot;Activate the lasso tool&quot;,
      action: {
        click: function (event) {
          lassoTool.activateSelection(event);
        }
      }
    },

    &quot;tool-separator&quot;: {
      group: &quot;tools&quot;,
      separator: true
    },

    &quot;create.start-event&quot;: createAction(
      &quot;bpmn:StartEvent&quot;,
      &quot;event&quot;,
      &quot;bpmn-icon-start-event-none&quot;,
      &quot;åˆ›å»ºå¼€å§‹èŠ‚ç‚¹&quot;
    ),
    &quot;create.end-event&quot;: createAction(
      &quot;bpmn:EndEvent&quot;,
      &quot;event&quot;,
      &quot;bpmn-icon-end-event-none&quot;,
      &quot;åˆ›å»ºç»“æŸèŠ‚ç‚¹&quot;
    ),
    &quot;create.user-task&quot;: createAction(
      &quot;bpmn:UserTask&quot;,
      &quot;activity&quot;,
      &quot;bpmn-icon-user-task&quot;,
      &quot;åˆ›å»ºç”¨æˆ·ä»»åŠ¡&quot;
    ),
    &quot;create.exclusive-gateway&quot;: createAction(
      &quot;bpmn:ExclusiveGateway&quot;,
      &quot;gateway&quot;,
      &quot;bpmn-icon-gateway-xor&quot;,
      &quot;åˆ›å»ºæ’ä»–ç½‘å…³&quot;
    )
  };
};</code></pre>


<p>è¿™æ®µä»£ç çš„æ„æ€ç›¸ä¿¡å„ä½å‰ç«¯çš„å¤§ä½¬æ¯”æˆ‘ç†è§£çš„è¦æ·±åˆ»ï¼Œå°±ä¸è¿‡å¤šä»‹ç»äº†ï¼ŒPlatteå±•ç¤ºçš„shapeå°±æ˜¯æœ€åreturnè¾“å‡ºçš„é‚£ä¸ªå­—å…¸æ•°æ®å®šä¹‰çš„ï¼Œä¸€ä¸ªshapeå¯¹åº”çš„æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre class="codehilite"><code>&quot;lasso-tool&quot;: {
  group: &quot;tools&quot;,
  className: &quot;bpmn-icon-lasso-tool&quot;,
  title: &quot;Activate the lasso tool&quot;,
  action: {
    click: function (event) {
      lassoTool.activateSelection(event);
    }
  }
}</code></pre>


<p>å…¶ä¸­keyä¸ºè¿™ä¸ªshapeçš„åç§°ï¼Œvalueä¸ºè¿™ä¸ªshapeå®šä¹‰çš„ä¸€äº›å±æ€§ï¼Œä¸»è¦æœ‰å››ä¸ªï¼š</p>
<ul>
<li><strong>groupï¼š</strong> å®šä¹‰è¿™ä¸ªshapeå±äºå“ªä¸ªç»„ï¼Œä¸»è¦æœ‰toolsã€eventã€gatewayå’Œactivityå¯ä»¥é€‰æ‹©</li>
<li><strong>classNameï¼š</strong> å®šä¹‰è¿™ä¸ªshapeçš„chassåç§°ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªclassç»™shapeæŒ‡å®šå…·ä½“çš„æ ·å¼</li>
<li><strong>titleï¼š</strong> å®šä¹‰è¿™ä¸ªshapeçš„titleï¼Œä¹Ÿå°±æ˜¯é¼ æ ‡ç§»åŠ¨åˆ°shapeä¸Šçš„æç¤º</li>
<li><strong>actionï¼š</strong> ç”¨æˆ·æ“ä½œæ—¶è§¦å‘çš„äº‹ä»¶</li>
</ul>
<p>é€šè¿‡è¿™ä¸ªæ•°æ®æˆ‘ä»¬å°±å¯ä»¥éšæ„æ·»åŠ ã€åˆ é™¤æˆ–è€…ä¿®æ”¹Paletteçš„shapeäº†ï¼Œæ”¹ä½ç½®è¯¥æ ·å¼è½»æ¾è‡ªå¦‚</p>
<p>3.åœ¨<code>custom/index.js</code>æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹å°†è‡ªå®šä¹‰çš„Paletteå¯¼å‡º</p>
<pre class="codehilite"><code>import CustomPalette from &quot;./CustomPalette&quot;;

export default {
  __init__: [&quot;paletteProvider&quot;],
  paletteProvider: [&quot;type&quot;, CustomPalette],
};</code></pre>


<p>4.åœ¨<code>customModeler/index.js</code>æ–‡ä»¶ä¸­ç¼–å†™è‡ªå®šä¹‰çš„<code>CustomModeler</code>ç±»</p>
<pre class="codehilite"><code>import inherits from &quot;inherits&quot;;

import Modeler from &quot;bpmn-js/lib/Modeler&quot;;

import CustomModule from &quot;./custom&quot;;

function CustomModeler(options) {
  Modeler.call(this, options);

  this._customElements = [];
}

inherits(CustomModeler, Modeler);

CustomModeler.prototype._modules = [].concat(CustomModeler.prototype._modules, [
  CustomModule
]);

export { CustomModeler };</code></pre>


<p>5.åœ¨é¡µé¢ä¸Šå¼•ç”¨è‡ªå®šä¹‰çš„<code>CustomModeler</code>ä»¥æ›¿ä»£åŸæœ¬å¼•ç”¨çš„<code>BpmnModeler</code>ç±»ï¼Œè¿™æ ·å°±èƒ½ç”¨åˆ°æˆ‘ä»¬è‡ªå®šä¹‰çš„Paletteå•¦</p>
<pre class="codehilite"><code>import { xmlStr } from &quot;../mock/xmlStrPreview&quot;;
import { CustomModeler } from &quot;../components/customBpmn&quot;;

export default {
  ...
  methods: {
    init() {
      const canvas = this.$refs.canvas;
      this.bpmnModeler = new CustomModeler({
        container: canvas
      });
      this.createNewDiagram();
    },
    async createNewDiagram() {
      try {
        const result = await this.bpmnModeler.importXML(xmlStr);
        const { warnings } = result;
        console.log(warnings);
      } catch (err) {
        console.log(err.message, err.warnings);
      }
    }
  }
};</code></pre>


<p>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img alt="" loading="lazy" src="/static/images/2020/1110.02.png" /></p>
<h2 id="shape_2">Shapeç±»å‹</h2>
<p>å…³äºShapeæ€»å…±æœ‰å“ªäº›ç±»å‹ï¼Œä»¥åŠå„è‡ªå¯¹åº”çš„å±æ€§éƒ½æ˜¯ä»€ä¹ˆï¼Œè¿™ä¸ªå®˜æ–¹æ²¡æœ‰å…·ä½“çš„æ–‡æ¡£ç»™åˆ—å‡ºï¼Œæˆ‘åœ¨ä½¿ç”¨çš„æ—¶å€™é€šå¸¸ç›´æ¥æŸ¥çœ‹æºç <a href="https://github.com/bpmn-io/bpmn-js/blob/develop/lib/features/palette/PaletteProvider.js" target="_blank"><code>bpmn-js/lib/features/palette/PaletteProvider.js</code></a>å’Œ<a href="https://github.com/bpmn-io/bpmn-js/blob/develop/lib/features/context-pad/ContextPadProvider.js" target="_blank"><code>bpmn-js/lib/features/context-pad/ContextPadProvider.js</code></a>æ–‡ä»¶è·å–ï¼Œå¯¹äºéƒ¨åˆ†ç±»å‹ï¼Œéœ€è¦æ·»åŠ optionsé€‰é¡¹</p>
<p>ä¾‹å¦‚ä¸­é—´æ—¶é—´äº‹ä»¶<code>IntermediateThrowEvent</code>æ‰€å¯¹åº”çš„å±æ€§ä¸ºï¼š</p>
<pre class="codehilite"><code>return {
  &quot;create.timer-intermediate-event&quot;: createAction(
    &quot;bpmn:IntermediateThrowEvent&quot;,
    &quot;event&quot;,
    &quot;bpmn-icon-intermediate-event-catch-timer&quot;,
    &quot;Create IntermediateThrowEvent&quot;,
    { eventDefinitionType: &quot;bpmn:TimerEventDefinition&quot; }
  )
};</code></pre>


<h2 id="_1">å†™åœ¨æœ€å</h2>
<p>æ¥è§¦bpmn-jsä¸ä¹…ï¼Œä¸”ç¬¬ä¸€æ¬¡ç”¨VUEï¼Œè¾¹å­¦è¾¹å†™ï¼Œæ–‡ç« éš¾å…å‡ºé”™ï¼Œå„ä½å¤šå¤šåŒ…å«ã€‚æƒ³è¦æ‰“é€ ä¸€ä¸ªå¥½ç”¨çš„é€‚åˆè‡ªå·±çš„æµç¨‹ç¼–è¾‘å™¨ï¼Œéœ€è¦äº†è§£çš„å†…å®¹æ¯”è¾ƒå¤šï¼Œbpmn-jsä¼šåˆ†å¤šç¯‡æ–‡ç« æ¥ä»‹ç»ï¼Œæ¬¢è¿å…³æ³¨</p>
<p>éƒ¨åˆ†å°ä¼™ä¼´å¯¹æµç¨‹ç¼–è¾‘å™¨ä¸äº†è§£ï¼Œæˆ–æ˜¯å¯¹BPMNä¸äº†è§£ï¼Œæˆ‘æ­å»ºäº†ä¸ªåœ¨çº¿çš„Demo: <a href="https://bpmn.ops-coffee.cn" target="_blank">https://bpmn.ops-coffee.cn</a>ï¼Œç‚¹å‡»é“¾æ¥å³å¯è½»æ¾ä½“éªŒï¼Œå»ºè®®PCç«¯æ‰“å¼€æ•ˆæœæ›´å¥½</p>

        <div>
          <ul style="display: inline-block;padding: 0;margin: 0 0 0.5em;color: #999;">
            <li style="display: inline-block;margin: 0 1em 0 0;"><a href="/bpmn/bpmn-js-vue-custom-palette-demo-code-source.html">ğŸ“… 2020-11-10</a></li>
<li style="display: inline-block;margin: 0 1em 0 0;"><a href="/tag/å…³äºæŠ€æœ¯/">ğŸ·ï¸ å…³äºæŠ€æœ¯</a></li>          </ul>
        </div>

        <hr>

        <div class="nav-cell">
            <script async src="https://giscus.app/client.js"
                    data-repo="ops-coffee/blog" data-repo-id="MDEwOlJlcG9zaXRvcnkxNDY4OTI0MTg="
                    data-category="Announcements" data-category-id="DIC_kwDOCMFmgs4CQar3"
                    data-mapping="pathname" data-strict="0" data-reactions-enabled="1"
                    data-emit-metadata="0" data-input-position="top" data-theme="light"
                    data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous">
            </script>
        </div>

        <div>
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8944257246828217"
                 data-ad-slot="6731434232" data-ad-format="auto" data-full-width-responsive="true"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>

        <div class="nav-cell">
            <p class="nav-list-title">èƒ½çœ‹åˆ°è¿™é‡Œä¸€å®šæ˜¯çœŸçˆ±ï¼Œå…³æ³¨ä¸€ä¸‹å§</p>
            <img alt="" loading="lazy" src="/static/images/wx.sou1.png" />
        </div>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
      <div class="copy"> Â© ops-coffee</div>

      <div class="link">
        <a href="/search.html" title="æœç´¢" target="_blank">æœç´¢</a>
        <a href="/questions.html" title="æé—®" target="_blank">æé—®</a>
        <a href="/friends.html" title="å‹æƒ…é“¾æ¥" target="_blank">å‹é“¾</a>
      </div>
    </div>
  </footer>
  
  <!-- Umami Cloud -->
<script async src="https://umami.ops-coffee.cn/script.js" data-website-id="a4aabd8e-32c7-40e7-a81c-119b909f2d0f"></script>

<!-- Google Adsense -->
<script data-ad-client="ca-pub-8944257246828217" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</body>

</html>