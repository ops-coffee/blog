<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="applicable-device" content="pc,mobile">
  <meta name="keywords" content="Django,Geek,åšå®¢,å…³äºæŠ€æœ¯" />
  <meta name="description" content="æ¯ä¸ªGeekå¯¹æŠ˜è…¾è‡ªå·±çš„åšå®¢éƒ½æœ‰ç€ä¸€ä»½æ‰§å¿µ" />
  <link rel="alternate" type="application/rss+xml" title="è¿ç»´å’–å•¡å§" href="https://blog.ops-coffee.cn/feed.xml" />
  <link rel="stylesheet" href="https://blog.ops-coffee.cn/static/posts/css/ops-coffee.min.css" type="text/css" />

  <!-- Begin SEO tag -->
  <title>åˆ©ç”¨Djangoå¾’æ‰‹å†™ä¸ªé™æ€é¡µé¢ç”Ÿæˆå·¥å…·</title>
  <meta property="og:locale" content="zh_CN" />
  <meta property="og:site_name" content="è¿ç»´å’–å•¡å§" />
  <meta property="og:url" content="https://blog.ops-coffee.cn" />
  <meta property="og:title" content="åˆ©ç”¨Djangoå¾’æ‰‹å†™ä¸ªé™æ€é¡µé¢ç”Ÿæˆå·¥å…·" />
  <meta property="og:description" content="æ¯ä¸ªGeekå¯¹æŠ˜è…¾è‡ªå·±çš„åšå®¢éƒ½æœ‰ç€ä¸€ä»½æ‰§å¿µ" />
  <link rel="canonical" href="https://blog.ops-coffee.cn" />
  <!-- End SEO tag -->
</head>

<body>
  <div class="header">
    <div class="container">
      <nav class="header-site">
        <ul>
          <li><a href="/">é¦–é¡µ</a></li>
            <li class="has-submenu">
              <a href="#" target="_self">è¿ç»´</a>
              <ul class="sub-menu">
                <li><a href="/tag/ç³»ç»Ÿè¿ç»´/" target="_self">ç³»ç»Ÿè¿ç»´</a></li>
                <li><a href="/elk/index.html" target="_self">ELKç³»åˆ—</a></li>
                <li><a href="/ldap/index.html" target="_self">LDAPç³»åˆ—</a></li>
              </ul>
            </li>
            <li class="has-submenu">
              <a href="#" target="_self">å¼€å‘</a>
              <ul class="sub-menu">
                <li><a href="/tag/Devops/" target="_self">DevOps</a></li>
                <li><a href="/tag/Python/" target="_self">Python</a></li>
                <li><a href="/tag/Django/" target="_self">Django</a></li>
                <li><a href="/bpmn/index.html" target="_self">BPMNç³»åˆ—</a></li>
                <li><a href="/webssh/index.html" target="_self">WebSSHç³»åˆ—</a></li>
                <li><a href="/frontend/index.html" target="_self">å‰ç«¯å¼€å‘ç³»åˆ—</a></li>
              </ul>
            </li>
            <li><a href="/devops.html" target="_self">è¿ç»´å¹³å°</a></li>
            <li><a href="/tag/è¿™æ˜¯ç”Ÿæ´»/" target="_self">è¿™æ˜¯ç”Ÿæ´»</a></li>
            <li class="has-submenu">
              <a href="#" target="_self">æˆ¿è½¦æ—…è¡Œ</a>
              <ul class="sub-menu">
                <li><a href="/r/index.html" target="_self">æˆ¿è½¦ä½“éªŒ</a></li>
                <li><a href="/travels.html" target="_self">æ—…è¡Œæ¸¸è®°</a></li>
              </ul>
            </li>
            <li><a href="/tag/index.html" target="_self">æ ‡ç­¾</a></li>
            <li><a href="/archive.html" target="_self">å½’æ¡£</a></li>
        </ul>
      </nav>
    </div>
  </div>

  <header>
    <div class="container">
      <a href="/">
        <h1>è¿ç»´å’–å•¡å§</h1>
        <h2>äº«å—æŠ€æœ¯å¸¦æ¥çš„ä¹è¶£ï¼Œä½“éªŒç”Ÿæ´»ç»™äºˆçš„æ„ŸåŠ¨</h2>
      </a>
    </div>
  </header>

  <div id="content-wrap">
    <div class="container">
        <h1 id="art-title">åˆ©ç”¨Djangoå¾’æ‰‹å†™ä¸ªé™æ€é¡µé¢ç”Ÿæˆå·¥å…·</h1>

        <blockquote>
<p>æ¯ä¸ªGeekå¯¹æŠ˜è…¾è‡ªå·±çš„åšå®¢éƒ½æœ‰ç€ä¸€ä»½æ‰§å¿µ</p>
</blockquote>
<h2 id="_1">èƒŒæ™¯ä»‹ç»</h2>
<p>æ›¾ç»å¤šæ¬¡åœ¨ä¸åŒçš„å¹³å°å†™åšå®¢ï¼Œä½†å…¨éƒ¨éƒ½ä»¥å¤±è´¥è€Œå‘Šç»ˆã€‚å»å¹´ä¸ƒæœˆé€‰æ‹©å¾®ä¿¡å…¬ä¼—å·åšä¸ºå¹³å°å¼€å§‹äº†åˆä¸€æ¬¡çš„æŠ€æœ¯åˆ†äº«ï¼Œåº†å¹¸ä¸€ç›´åšæŒåˆ°ç°åœ¨ï¼Œä½†éšç€æ–‡ç« å‘è¡¨çš„è¶Šæ¥è¶Šå¤šï¼Œå‘ç°å…¬ä¼—å·å¯¹äºPCç«¯å¾ˆä¸å‹å¥½ï¼Œæ–‡ç« åˆ—è¡¨æ²¡æœ‰PCç«¯å…¥å£ï¼ŒæŸ¥çœ‹åˆ†äº«å¾ˆä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥å°±åˆ©ç”¨github pagesæ­å»ºäº†ä¸€ä¸ª<a href="https://ops-coffee.cn" target="_blank">ã€è¿ç»´å’–å•¡å§ã€‘</a>çš„ç½‘ç«™ï¼Œåˆ†ç±»å±•ç¤ºå…¬ä¼—å·å†…å‘è¡¨çš„æ‰€æœ‰æ–‡ç« ä»¥åŠä¸€äº›æœªåœ¨å…¬ä¼—å·å‘è¡¨çš„çç¢å†…å®¹</p>
<p>ä¸ºäº†è¿½æ±‚æé€Ÿçš„æµè§ˆä½“éªŒï¼Œæ•´ä¸ªç½‘ç«™é‡‡ç”¨çº¯é™æ€çš„æ–¹å¼æ„å»ºï¼Œè¿™é‡Œçš„é™æ€å¹¶ä¸æ˜¯åƒJekyllæˆ–è€…Hexoä¹‹ç±»çš„é™æ€åšå®¢æ¡†æ¶ï¼Œè€Œæ˜¯æ‰‹å†™HTMLï¼Œé¡µé¢å°‘çš„æ—¶å€™è¿˜èƒ½åº”å¯¹ï¼Œä½†éšç€é¡µé¢è¶Šæ¥è¶Šå¤šï¼Œç»´æŠ¤è¿™äº›å†…å®¹å°±æˆäº†ç¾éš¾ï¼Œå¥½åœ¨å¯¹Djangoæ¯”è¾ƒç†Ÿæ‚‰ï¼Œäºæ˜¯ä¾¿åŠ¨æ‰‹å†™äº†è¿™ä¹ˆä¸€ä¸ªé™æ€åšå®¢é¡µé¢ç”Ÿæˆå·¥å…·</p>
<h2 id="_2">ä¸»è¦åŠŸèƒ½</h2>
<p>ç½‘ç«™éå¸¸ç®€å•ï¼Œåªæœ‰ä¸‰ç±»é¡µé¢ï¼Œä¸»é¡µã€æ–‡ç« åˆ—è¡¨é¡µå’Œæ–‡ç« è¯¦æƒ…é¡µ</p>
<ul>
<li>ä¸»é¡µç”¨æ¥åˆ†ç±»å±•ç¤ºå…¬ä¼—å·å†…çš„æ–‡ç« åˆ—è¡¨</li>
<li>æ–‡ç« åˆ—è¡¨é¡µç”¨æ¥å±•ç¤ºç½‘ç«™å†…æ–‡ç« ï¼ˆä¸€äº›çç¢çš„æœªåœ¨å…¬ä¼—å·å‘è¡¨çš„æ–‡ç« ï¼‰çš„åˆ—è¡¨</li>
<li>æ–‡ç« è¯¦æƒ…é¡µç”¨æ¥å±•ç¤ºå…·ä½“æ–‡ç« çš„å†…å®¹</li>
</ul>
<p>åŸºäºä»¥ä¸Šçš„å†…å®¹åˆ†æï¼Œå…¶å®åªéœ€è¦åšä¸¤ä¸ªåå°é¡µé¢ï¼ŒåŒ…å«å‡ ä¸ªå°åŠŸèƒ½ï¼Œç”»ä¸ªæ€ç»´å¯¼å›¾</p>
<p><img alt="" loading="lazy" src="/static/images/2019/0525.blog.png" /></p>
<p>é¦–é¡µä¸ºä»€ä¹ˆè¦å»è¯»å–JSONæ–‡ä»¶å‘¢ï¼Ÿä¸»è¦æ˜¯å› ä¸ºè¿ç»´å’–å•¡å§çš„å°ç¨‹åºä¹ŸåŒæ—¶ä¾èµ–è¿™ä¸ªJSONæ–‡ä»¶ï¼Œä¿®æ”¹ä¸€ä¸ªåœ°æ–¹é¿å…ç»´æŠ¤å¤šä»½æ•°æ®</p>
<p>æœ€ç»ˆå®ç°çš„æ•ˆæœå¦‚ä¸‹å›¾</p>
<p><img alt="" loading="lazy" src="/static/images/2019/0525.blog.gif" /></p>
<p>æ¥ä¸‹æ¥ä»‹ç»ä¸‹å®ç°è¿™äº›åŠŸèƒ½ç”¨åˆ°çš„æŠ€æœ¯æˆ–ç»„ä»¶</p>
<h2 id="_3">æ‰€ç”¨æŠ€æœ¯</h2>
<h3 id="_4">è¯»å–åŠå†™å…¥æ–‡ä»¶</h3>
<pre class="codehilite"><code>from django.conf import settings


class FileRun:
    def __init__(self):
        self.file = settings.BASE_DIR + '/ops_coffee/backends/blog.json'

    def read(self):
        try:
            with open(self.file, 'r', encoding='utf8') as f:
                return True, f.read()

        except Exception as e:
            return False, str(e)

    def write(self, content):
        try:
            with open(self.file, 'w', encoding='utf8') as f:
                return True, f.write(content)

        except Exception as e:
            return False, str(e)</code></pre>


<p>è¯»å–åŠå†™å…¥æ–‡ä»¶çš„æ“ä½œä¸Djangoçš„Viewæ²¡æœ‰å¤ªå¤§çš„å…³ç³»ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ç”¨äº†ä¸€ä¸ªå•ç‹¬çš„ç±»æ¥å¤„ç†ï¼Œè§£é‡Šä¸‹å…¶ä¸­çš„å››ä¸ªç”¨æ³•</p>
<ol>
<li>
<p>æœ¬åœ°æ–‡ä»¶è·¯å¾„ä¸è¦ç¡¬ç¼–ç åˆ°ä»£ç ä¸­ï¼Œå°½é‡é‡‡ç”¨<code>settings.BASE_DIR</code>ç›¸å¯¹è·¯å¾„ï¼Œæˆ–è€…ç›´æ¥å°†è·¯å¾„ä»¥å˜é‡çš„å½¢å¼å†™å…¥åˆ°settingsæ–‡ä»¶ï¼Œä¾‹å¦‚æˆ‘ä»¬åè¾¹è¦è¯´çš„ç”Ÿæˆæœ¬åœ°æ–‡ä»¶çš„ç›®å½•å°±ç›´æ¥åœ¨settingsä¸­æ·»åŠ äº†ä¸€ä¸ªå˜é‡<code>OPS_COFFEE_GIT_DIR</code></p>
</li>
<li>
<p>æ¯ä¸ªæ–¹æ³•è¿”å›ä¸¤ä¸ªå‚æ•°çŠ¶æ€å’Œæ•°æ®<code>return True,data</code>ï¼Œè¿™æ ·åœ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ¤æ–­å‡ºæ¥è¿™ä¸ªæ–¹æ³•æ˜¯æ‰§è¡ŒæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œä¾‹å¦‚å¦‚ä¸‹ä»£ç </p>
</li>
</ol>
<pre class="codehilite"><code>state, data = FileRun().read()
if state:
    return(data)</code></pre>


<ol>
<li>
<p>è¯»å–æ–‡ä»¶ä½¿ç”¨<code>with</code>æ–¹æ³•å¯ä»¥åœ¨ä½ è¯»å–ç»“æŸåè‡ªåŠ¨æ‰§è¡Œ<code>f.close()</code>å…³é—­æ–‡ä»¶ï¼Œé¿å…å› æ‰“å¼€æ–‡ä»¶è¿‡å¤šé€ æˆçš„èµ„æºæ¶ˆè€—</p>
</li>
<li>
<p>ä½¿ç”¨tryæ¥é¿å…ç¨‹åºç›´æ¥æŠ›é”™ï¼Œæœ‰é”™è¯¯å¤„ç†æœºåˆ¶</p>
</li>
</ol>
<h3 id="json">JSONæ ¼å¼åŒ–</h3>
<p>ä¸ºäº†å±•ç¤ºå¥½çœ‹ä¸”èƒ½å®ç°è¯­æ³•é”™è¯¯æç¤ºï¼Œé‡‡ç”¨äº†<code>jsoneditor</code>æ’ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªå‰ç«¯çš„æ’ä»¶ï¼Œä½¿ç”¨éå¸¸ç®€å•</p>
<pre class="codehilite"><code>&lt;div class=&quot;col-sm-12&quot; id=&quot;jsoneditor&quot; style=&quot;height:620px&quot;&gt;&lt;/div&gt;</code></pre>


<pre class="codehilite"><code>&lt;script src=&quot;/static/js/jsoneditor.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  // create the editor
  var container = document.getElementById(&quot;jsoneditor&quot;);
  var editor = new JSONEditor(container, {
    mode: 'code'
  });

  // set json
  editor.set({{ data|safe }});
&lt;/script&gt;</code></pre>


<p><strong>JSON Editor</strong> å¯ä»¥ç”¨æ¥æŸ¥çœ‹ã€ç¼–è¾‘ã€æ ¼å¼åŒ–å’ŒéªŒè¯JSONï¼Œæ”¯æŒå¤šç§æ¨¡å¼ï¼Œä¾‹å¦‚treeã€codeã€textï¼Œå½“ä¸ºtreeæ¨¡å¼æ—¶æ˜¾ç¤ºæ ‘çŠ¶ç»“æ„ï¼Œå½“ä¸ºtextæ—¶æ˜¾ç¤ºçº¯æ–‡æœ¬ï¼Œæˆ‘ä»¬è¿™é‡Œé‡‡ç”¨äº†codeæ¨¡å¼æœ‰è¡Œå·å’Œé¢œè‰²ï¼Œçœ‹èµ·æ¥æ›´ç¾è§‚</p>
<p><strong>safe</strong> djangoä»viewå‘templateä¼ é€’HTMLæ•°æ®çš„æ—¶å€™ï¼Œä¸ºäº†é˜²æ­¢htmlä¸­åŒ…å«æ¶æ„æ”»å‡»çš„ä»£ç djangoé»˜è®¤ä¸ä¼šæ¸²æŸ“HTMLï¼Œæ‰€ä»¥éœ€è¦åœ¨templateæ¥æ”¶åˆ°htmlæ•°æ®åæ·»åŠ <code>|safe</code>è¿›è¡Œæ¸²æŸ“</p>
<h3 id="html">ç”ŸæˆHTML</h3>
<p>è§‚å¯Ÿä¼šå‘ç°æ•´ä¸ªç½‘ç«™é‡Œæ‰€æœ‰çš„é¡µé¢é™¤äº†ä¸­é—´çš„å†…å®¹åŒºåŸŸä¹‹å¤–ï¼Œå…¶ä»–çš„åœ°æ–¹éƒ½ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è€ƒè™‘æ›¿æ¢ä¸­é—´çš„å†…å®¹å°±å¯ä»¥äº†ï¼Œå®é™…ä¸Šä¸ºäº†SEOç­‰æˆ‘ä»¬è¿˜éœ€è¦æ›¿æ¢titleç­‰æ•°æ®</p>
<p>æ›¿æ¢å†…å®¹ç”Ÿæˆhtmlæ–‡ä»¶è¿™é‡Œä½¿ç”¨äº†jinja2ï¼Œæˆ‘æœ‰å°è¯•ç›´æ¥ç”¨djangoçš„templateæ¥æ¸²æŸ“ï¼Œä½†æœ€ç»ˆæœ‰ä¸€äº›ç¼–ç é—®é¢˜æ²¡æœ‰è§£å†³ï¼Œè¿˜æ˜¯é‡‡ç”¨äº†jinja2ï¼Œä»£ç å¦‚ä¸‹</p>
<pre class="codehilite"><code>from jinja2 import Template
from django.conf import settings

tmpl = &quot;&quot;&quot;&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;zh-CN&quot;&gt;

&lt;head&gt;
  &lt;meta name=&quot;theme-color&quot; content=&quot;#2879d0&quot; /&gt;
  &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/style.min.css&quot; media=&quot;screen&quot; type=&quot;text/css&quot; /&gt;

  &lt;title&gt;{{ title }}&lt;/title&gt;
  &lt;meta property=&quot;og:title&quot; content=&quot;{{ title }}&quot; /&gt;
  &lt;meta property=&quot;og:description&quot; content=&quot;{{ description }}&quot; /&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;header&gt;
    &lt;div class=&quot;inner&quot;&gt;
      &lt;a href=&quot;https://ops-coffee.cn/&quot;&gt;
        &lt;h1&gt;è¿ç»´å’–å•¡å§&lt;/h1&gt;
      &lt;/a&gt;
      &lt;h2&gt;è¿½æ±‚æŠ€æœ¯çš„é“è·¯ä¸Šï¼Œæˆ‘ä»ä¸æ›¾åœä¸‹è„šæ­¥&lt;/h2&gt;
    &lt;/div&gt;
  &lt;/header&gt;

  &lt;div id=&quot;content-wrapper&quot;&gt;
    &lt;div class=&quot;inner clearfix&quot;&gt;
      &lt;section id=&quot;main-content&quot;&gt;
      {% if havet %}
        &lt;h1 id=&quot;art-title&quot;&gt;{{ title }}&lt;/h1&gt;
      {% endif %}

      {{ content }}
      &lt;/section&gt;

      &lt;aside id=&quot;sidebar&quot;&gt;
        &lt;blockquote class=&quot;route&quot;&gt;å¾®ä¿¡å…¬ä¼—å·&lt;/blockquote&gt;
        &lt;img border=&quot;0&quot; src=&quot;/images/z-qrcode.jpg&quot; width=&quot;100%&quot; height=&quot;100%&quot; alt=&quot;ops-coffee&quot; /&gt;

        &lt;blockquote class=&quot;route&quot;&gt;å½’æ¡£åˆ—è¡¨&lt;/blockquote&gt;
        &lt;div class=&quot;sidebar-list&quot;&gt;&lt;a href=&quot;/&quot;&gt; ç²¾é€‰æ–‡ç« åˆ—è¡¨&lt;/a&gt;&lt;/div&gt;
        &lt;div class=&quot;sidebar-list&quot;&gt;&lt;a href=&quot;/s/&quot;&gt; æ—¥å¸¸è¿ç»´è®°å½•&lt;/a&gt;&lt;/div&gt;
      &lt;/aside&gt;
    &lt;/div&gt;
  &lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;
&quot;&quot;&quot;

kwargs = {
    &quot;havet&quot;: 0,
    &quot;title&quot;: &quot;è¿ç»´å’–å•¡å§&quot;,
    &quot;description&quot;: &quot;è¿½æ±‚æŠ€æœ¯çš„é“è·¯ä¸Šï¼Œæˆ‘ä»ä¸æ›¾åœä¸‹è„šæ­¥&quot;,
    &quot;content&quot;: content
}

_content = Template(tmpl).render(kwargs)
with open(self.blogDir + '/index.html', 'w', encoding='utf8') as f:
    f.write(_content)</code></pre>


<p><strong>tmpl</strong> å®šä¹‰äº†ä¸€ä¸ªæ¨¡ç‰ˆï¼Œæ¨¡ç‰ˆå†…å¯ä»¥ä½¿ç”¨è¯¸å¦‚<code>{{ title }}</code>è¿™æ ·çš„å˜é‡æˆ–æ˜¯<code>{% if havet %}</code>è¿™æ ·çš„è¯­æ³•</p>
<p><strong>kwargs</strong> å®šä¹‰äº†ä¸€ä¸ªå­—å…¸ï¼Œå­—å…¸çš„å†…å®¹ç”¨æ¥æ›¿æ¢æ¨¡ç‰ˆä¸­çš„å˜é‡ï¼Œå­—å…¸çš„keyå€¼ä¸æ¨¡ç‰ˆé‡Œè¾¹çš„å˜é‡åšåŒ¹é…ï¼ŒåŒ¹é…åˆ°äº†å°±ç”¨å­—å…¸çš„valueå¡«å……æ¨¡ç‰ˆ</p>
<p><strong>_content</strong> å°±æ˜¯æœ€ç»ˆhtmlçš„å†…å®¹ï¼Œ<code>Template(tmpl).render(kwargs)</code>ä¼šå°†kwargsçš„æ¯ä¸ªkeyå€¼ä¸æ¨¡ç‰ˆä¸­çš„å˜é‡åšæ›¿æ¢</p>
<p>æœ€åä¼šå°†htmlå†…å®¹å†™å…¥åˆ°htmlæ–‡ä»¶</p>
<h3 id="github">ä¸Šä¼ GitHub</h3>
<p>ç½‘ç«™ä½¿ç”¨github pagesæ­å»ºï¼Œæœ€åéœ€è¦å°†ç”Ÿæˆçš„htmlæ–‡ä»¶ä¸Šä¼ åˆ°githubï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†<code>gitpython</code>åº“ï¼Œgitpythonåº“çš„ç”¨æ³•è·ŸåŸç”Ÿgitçš„å‘½ä»¤éå¸¸åƒï¼Œåªæ˜¯å‘½ä»¤ä¸­é—´ä»¥<code>.</code>è¿æ¥</p>
<p>æœ€ä½³çš„è‡ªåŠ¨ä¸Šä¼ æ­¥éª¤åº”è¯¥æ˜¯ï¼š</p>
<ol>
<li>æœ¬åœ°ç”Ÿæˆsshå¯†é’¥ï¼Œå¹¶å°†å…¬é’¥ä¸Šä¼ è‡³githubï¼Œå®ç°æœ¬æœºä¸sshä¹‹é—´çš„æ— å¯†ç ä¸Šä¼ ä¸‹è½½</li>
<li>æœ¬åœ°åˆ›å»ºç½‘ç«™ç›®å½•ï¼Œè¿™ä¸ªç›®å½•éœ€è¦è·Ÿsettingsé‡Œè¾¹çš„<code>OPS_COFFEE_GIT_DIR</code>å˜é‡ä¸€è‡´ï¼Œæ–¹ä¾¿ç›´æ¥å°†htmlæ–‡ä»¶ç”Ÿæˆåœ¨è¿™ä¸ªç›®å½•ä¸‹</li>
<li>è¿›å…¥ç½‘ç«™ç›®å½•å¹¶ä½¿ç”¨<code>git clone</code>æ‹‰å–githubä¸Šçš„ä»£ç ï¼Œæ³¨æ„è¿™é‡Œåº”é€‰æ‹©sshåè®®çš„urlï¼Œä¾‹å¦‚ï¼š<code>git clone git@github.com:ops-coffee/demo.git .</code>ï¼Œä¸”ç¡®å®šæ— éœ€è¾“å…¥è´¦å·å¯†ç å³å¯æ‹‰å–</li>
<li>ç„¶åå°±å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç¨‹åºå®ç°è‡ªåŠ¨ä¸Šä¼ æ›´æ–°åˆ°githubäº†ï¼Œä¹Ÿå°±æ˜¯åœ¨è·‘æœ¬æ–‡æ‰€è®²çš„è¿™ä¸ªç”Ÿæˆå·¥å…·ä¹‹å‰éœ€è¦å…ˆåšå¥½ä»¥ä¸Šä¸‰æ­¥</li>
</ol>
<pre class="codehilite"><code>from git import Repo
from django.conf import settings


class GitRun:
    def __init__(self):
        self.repo = Repo(settings.OPS_COFFEE_GIT_DIR)

    def push(self):
        try:
            self.repo.git.add(A=True)
            self.repo.index.commit('ops-coffee')
            self.repo.remote(name='origin').push()

            return True, True
        except Exception as e:
            return False, str(e)</code></pre>


<p><strong>Repo()</strong> é€‰æ‹©å·²æœ‰çš„gitä»“åº“</p>
<p><strong>git.add</strong> æ·»åŠ æœ¬åœ°ä¿®æ”¹åˆ°æš‚å­˜åŒºï¼Œ<code>A=True</code>æ·»åŠ åˆ°æš‚å­˜åŒºæ—¶åŒ…å«åˆ é™¤æ–‡ä»¶çš„ä¿®æ”¹</p>
<p><strong>index.commit</strong> æäº¤ä¿®æ”¹åˆ°æœ¬åœ°ä»“åº“ï¼Œæˆ‘è¿™é‡Œæ¯”è¾ƒç²—ç³™ï¼Œç»Ÿä¸€ä½¿ç”¨<code>ops-coffee</code>åšä¸ºlog</p>
<p><strong>repo.remote().push()</strong> é€‰æ‹©è¿œç¨‹åˆ†æ”¯å¹¶æäº¤ï¼Œnameå‚æ•°è¡¨ç¤ºè¿œç¨‹åˆ†æ”¯çš„åå­—</p>
<h3 id="_5">ç™»é™†ç™»å‡º</h3>
<p>è™½ç„¶æ˜¯ä¸ªç®€å•çš„ä¸ªäººç³»ç»Ÿï¼Œä½†æœ€åŸºæœ¬çš„ç”¨æˆ·è®¤è¯è¿˜æ˜¯è¦æœ‰çš„ï¼Œæ²¡æœ‰ç”¨Djangoé»˜è®¤çš„adminé¡µé¢ï¼Œä½†è¿˜æƒ³ä½¿ç”¨djangoæä¾›çš„authç³»ç»Ÿå®ç°ç™»é™†ç™»å‡ºçš„è¯ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹è¾¹è¿™ç§æ–¹å¼</p>
<pre class="codehilite"><code>from django.urls import path
from django.contrib.auth.views import LoginView, LogoutView

urlpatterns = [
    path('login', LoginView.as_view(template_name='login.html'), name='login-url'),
    path('logout', LogoutView.as_view(template_name='login.html'), name='logout-url'),
]</code></pre>


<p>ä»<code>django.contrib.auth.views</code>ä¸‹å¯¼å…¥<code>LoginView</code>å’Œ<code>LogoutView</code>ï¼Œç„¶åå†™ä¸¤æ¡urlå¹¶æŒ‡å®šè‡ªå·±çš„æ¨¡ç‰ˆä½ç½®å°±å¯ä»¥ä½¿ç”¨djangoçš„ç™»é™†ç™»å‡ºåŠŸèƒ½äº†ï¼Œè¿™åœ¨ä¸€äº›éœ€è¦ç®€å•è®¤è¯çš„ç³»ç»Ÿä¸­éå¸¸æ–¹ä¾¿</p>
<h2 id="_6">å†™åœ¨æœ€å</h2>
<p>ä¸æ–­æŠ˜è…¾çš„è¿‡ç¨‹æ‰æ˜¯æˆé•¿æœ€å¿«çš„è¿‡ç¨‹ï¼Œç”¨æŠ€æœ¯æ¥è§£å†³å®é™…çš„é—®é¢˜æ˜¯å¯¹æŠ€æœ¯æœ€å¥½çš„åº”ç”¨</p>
<p>å¦‚æœä½ å¯¹æœ¬ç¯‡æ–‡ç« çš„å®Œæ•´æºç æ„Ÿå…´è¶£ï¼Œå¯ä»¥åœ¨å¾®ä¿¡å…¬ä¼—å·åå°å›å¤â€œ05â€è·å–ï¼Œå½“ç„¶ä¹Ÿéå¸¸æ¬¢è¿åŠ æˆ‘ä¸ªäººå¾®ä¿¡ä¸€èµ·å­¦ä¹ äº¤æµ</p>

        <div>
          <ul style="display: inline-block;padding: 0;margin: 0 0 0.5em;color: #999;">
            <li style="display: inline-block;margin: 0 1em 0 0;"><a href="/s/7g2wncQG1lIziOmtBxXwEw.html">ğŸ“… 2019-05-27</a></li>
<li style="display: inline-block;margin: 0 1em 0 0;"><a href="/tag/Django/">ğŸ·ï¸ Django</a></li><li style="display: inline-block;margin: 0 1em 0 0;"><a href="/tag/åšå®¢/">ğŸ·ï¸ åšå®¢</a></li><li style="display: inline-block;margin: 0 1em 0 0;"><a href="/tag/å…³äºæŠ€æœ¯/">ğŸ·ï¸ å…³äºæŠ€æœ¯</a></li>          </ul>
        </div>

        <hr>

        <div class="nav-cell">
            <script async src="https://giscus.app/client.js"
                    data-repo="ops-coffee/blog" data-repo-id="MDEwOlJlcG9zaXRvcnkxNDY4OTI0MTg="
                    data-category="Announcements" data-category-id="DIC_kwDOCMFmgs4CQar3"
                    data-mapping="pathname" data-strict="0" data-reactions-enabled="1"
                    data-emit-metadata="0" data-input-position="top" data-theme="light"
                    data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous">
            </script>
        </div>

        <div>
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8944257246828217"
                 data-ad-slot="6731434232" data-ad-format="auto" data-full-width-responsive="true"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>

        <div class="nav-cell">
            <p class="nav-list-title">èƒ½çœ‹åˆ°è¿™é‡Œä¸€å®šæ˜¯çœŸçˆ±ï¼Œå…³æ³¨ä¸€ä¸‹å§</p>
            <img alt="" loading="lazy" src="/static/images/wx.sou1.png" />
        </div>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
      <div class="copy"> Â© ops-coffee</div>

      <div class="link">
        <a href="/search.html" title="æœç´¢" target="_blank">æœç´¢</a>
        <a href="/questions.html" title="æé—®" target="_blank">æé—®</a>
        <a href="/friends.html" title="å‹æƒ…é“¾æ¥" target="_blank">å‹é“¾</a>
      </div>
    </div>
  </footer>
  
  <!-- Umami Cloud -->
<script async src="https://umami.ops-coffee.cn/script.js" data-website-id="a4aabd8e-32c7-40e7-a81c-119b909f2d0f"></script>

<!-- Google Adsense -->
<script data-ad-client="ca-pub-8944257246828217" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</body>

</html>